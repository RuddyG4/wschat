import{Q as j,k as l,T as M,l as N,m as O,p as x,o as t,f as a,a as y,u as m,w as b,F as C,Z as V,b as e,t as _,d as p,q as U,g as z,i as D,s as E,x as F}from"./app-owxbHU6M.js";import{_ as q}from"./AuthenticatedLayout-bGhJ2ggw.js";import"./ApplicationLogo-fkh8xc42.js";const I=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Chat view",-1),K={class:"py-8"},$={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},H={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},L={class:"p-4 text-gray-900 relative h-[75vh]"},P={class:"chat max-h-[70vh]"},Q={class:"chat-title"},W={key:0},Z=e("span",{class:"inline-flex w-2 h-2 me-1 bg-green-500 rounded-full"},null,-1),A={key:1},G=e("span",{class:"inline-flex w-2 h-2 me-1 bg-red-500 rounded-full"},null,-1),J=e("figure",{class:"avatar"},[e("img",{src:"https://s3-us-west-2.amazonaws.com/s.cdpn.io/156381/profile/profile-80.jpg"})],-1),R={id:"messages",class:"messages"},X={class:"messages-content mCustomScrollbar _mCS_1"},Y={id:"mCSB_1",class:"mCustomScrollBox mCS-light mCSB_vertical mCSB_inside",style:{"max-height":"none"},tabindex:"0"},ss={id:"mCSB_1_container",class:"mCSB_container",style:{position:"relative",top:"-7px",left:"0px"},dir:"ltr"},es={key:0,class:"message message-personal new"},ts={key:1,class:"message new"},as=e("figure",{class:"avatar"},[e("img",{src:"https://s3-us-west-2.amazonaws.com/s.cdpn.io/156381/profile/profile-80.jpg"})],-1),os=e("div",{class:"timestamp"},"16:39",-1),ns={key:0,class:"message loading new"},is=e("figure",{class:"avatar"},[e("img",{src:"https://s3-us-west-2.amazonaws.com/s.cdpn.io/156381/profile/profile-80.jpg"})],-1),ls=e("span",null,null,-1),cs=[is,ls],ds={class:"message-box"},rs=e("div",{class:"bg"},null,-1),_s={__name:"Index",props:{chat:Object,messages:Object},setup(S){const B=j(),o=S,g=l(o.messages),v=l(Echo.join("chat."+o.chat.id)),f=l(!1),c=l(!1),d=l(null),n=l(!1),i=M({message:""}),u=async()=>{await new Promise(h=>setTimeout(h,80));const s=document.getElementById("messages");s&&(s.scrollTop=s.scrollHeight)},w=function(){i.message!=""&&(i.post(route("chat.message.send",o.chat.id)),u(),i.message="")};N(function(){u(),v.value.listen("MessageSent",s=>{k(s.message)}).listenForWhisper("typing",s=>{f.value=s.typing,u()}).here(s=>{s.length>1&&(n.value=!0)}).joining(s=>{!n.value&&s.id===d.value.id&&(n.value=!0)}).leaving(s=>{n.value&&s.id===d.value.id&&(n.value=!1)})}),O(function(){T()});function k(s){g.value.push(s),u()}function T(){let s=0;for(;d.value==null&&s<o.chat.users.length;)o.chat.users[s].id!==B.props.auth.user.id&&(d.value=o.chat.users[s]),s++}return x(()=>i.message,s=>{!c.value&&s!==""&&(c.value=!0),c.value&&s===""&&(c.value=!1)}),x(c,s=>{v.value.whisper("typing",{typing:s})}),(s,h)=>(t(),a(C,null,[y(m(V),{title:"Dashboard"}),y(q,null,{header:b(()=>[I]),default:b(()=>[e("div",K,[e("div",$,[e("div",H,[e("div",L,[e("div",P,[e("div",Q,[e("h1",null,_(d.value.name),1),n.value?(t(),a("h2",W,[Z,p(" Online ")])):(t(),a("h2",A,[G,p(" Offline ")])),J]),e("div",R,[e("div",X,[e("div",Y,[e("div",ss,[(t(!0),a(C,null,U(g.value,r=>(t(),a("div",null,[r.user_id==s.$page.props.auth.user.id?(t(),a("div",es,_(r.content),1)):(t(),a("div",ts,[as,p(_(r.content)+" ",1),os]))]))),256)),f.value?(t(),a("div",ns,cs)):z("",!0)])])])]),e("div",ds,[D(e("textarea",{onKeyup:F(w,["enter"]),"onUpdate:modelValue":h[0]||(h[0]=r=>m(i).message=r),type:"text",class:"message-input",placeholder:"Type message...",required:"",autofocus:""},null,544),[[E,m(i).message]]),e("button",{type:"button",class:"message-submit",onClick:w},"Send")])]),rs])])])])]),_:1})],64))}};export{_s as default};
